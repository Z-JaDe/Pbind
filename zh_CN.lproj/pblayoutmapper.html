<h2><a href="/Pbind/cn/pblayoutmapper#布局配置" id=布局配置 aria-hidden="true" class="anchor"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>布局配置</h2>
<p>布局配置使用官方的AutoLayout，属性包括：</p>
<h3><a href="/Pbind/cn/pblayoutmapper#views" id=views aria-hidden="true" class="anchor"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>views</h3>
<p>视图字典，每个 <em>Key</em> 对应视图别名，<em>Value</em> 对应一个字典，来描述视图。</p>
<h3><a href="/Pbind/cn/pblayoutmapper#metrics" id=metrics aria-hidden="true" class="anchor"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>metrics</h3>
<p>边距字典，每个 <em>Key</em> 对应边距别名，<em>Value</em> 对应浮点值。</p>
<h3><a href="/Pbind/cn/pblayoutmapper#formats" id=formats aria-hidden="true" class="anchor"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>formats</h3>
<p>约束描述语言数组，每项对应官方的 <em>VFL</em>。</p>
<h3><a href="/Pbind/cn/pblayoutmapper#constraints" id=constraints aria-hidden="true" class="anchor"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>constraints</h3>
<p>Pbind自定义约束描述语言 <em>PVFL</em> 数组，格式如下：</p>
<h4><a href="/Pbind/cn/pblayoutmapper#1.-常规约束" id=1.-常规约束 aria-hidden="true" class="anchor"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 常规约束</h4>
<p><code>[视图一].[属性一][关系][视图二].[属性二]*[系数]+[差量]@[优先级]</code></p>

<p><strong>视图</strong> 为视图字典的 <em>Key</em>。</p>

<p><strong>属性</strong> 定义如下：</p>

<table><thead>
<tr>
<th>属性</th>
<th>NSLayoutAttribute</th>
</tr>
</thead><tbody>
<tr>
<td>left</td>
<td>NSLayoutAttributeLeft</td>
</tr>
<tr>
<td>right</td>
<td>NSLayoutAttributeRight</td>
</tr>
<tr>
<td>top</td>
<td>NSLayoutAttributeTop</td>
</tr>
<tr>
<td>bottom</td>
<td>NSLayoutAttributeBottom</td>
</tr>
<tr>
<td>leading</td>
<td>NSLayoutAttributeLeading</td>
</tr>
<tr>
<td>trailing</td>
<td>NSLayoutAttributeTrailing</td>
</tr>
<tr>
<td>width</td>
<td>NSLayoutAttributeWidth</td>
</tr>
<tr>
<td>height</td>
<td>NSLayoutAttributeHeight</td>
</tr>
<tr>
<td>centerX</td>
<td>NSLayoutAttributeCenterX</td>
</tr>
<tr>
<td>centerY</td>
<td>NSLayoutAttributeCenterY</td>
</tr>
<tr>
<td>baseline</td>
<td>NSLayoutAttributeBaseline</td>
</tr>
</tbody></table>

<p><strong>关系</strong> 除 <em>VFL</em> 外，允许单等号 &#39;=&#39;。</p>

<p><strong>系数</strong> 浮点数，同 <em>VFL</em> 。</p>

<p><strong>差量</strong> 浮点数，UI标注图上的尺寸，根据设备自动适配。</p>

<p><strong>优先级</strong> 整型，同 <em>UILayoutPriority</em> ，默认为 <em>UILayoutPriorityRequired</em> (1000)。</p>

<p>示例：</p>

<p><code>icon.width=icon.height</code>
<code>label1.baseline=icon.top+2</code>
<code>label1.height=label2.height*2+20@750</code></p>
<h4><a href="/Pbind/cn/pblayoutmapper#2.-特殊约束" id=2.-特殊约束 aria-hidden="true" class="anchor"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 特殊约束</h4>
<p>特殊约束使用一个大写字母标记+冒号为前缀，识别的标记包括：</p>

<table><thead>
<tr>
<th>标记</th>
<th>含义</th>
<th>示例</th>
</tr>
</thead><tbody>
<tr>
<td>R</td>
<td>宽高比</td>
<td><code>R:icon=1</code>, <code>R:icon=4:3</code></td>
</tr>
<tr>
<td>E</td>
<td>内边距</td>
<td><code>E:inner={20,30,20,30}</code>, <code>E:outer-inner={20,30,20,30}</code></td>
</tr>
<tr>
<td>C</td>
<td>水平合并居中</td>
<td>C:&#124;-left-[/[name]-[desc]/(==height)]-[icon]-&#124;</td>
</tr>
<tr>
<td>M</td>
<td>垂直合并居中</td>
<td>M:&#124;-left-[/[name]-[desc]/(==width)]-[icon]-&#124;</td>
</tr>
</tbody></table>
<h5><a href="/Pbind/cn/pblayoutmapper#宽高比" id=宽高比 aria-hidden="true" class="anchor"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>宽高比</h5>
<p>浮点数，你可以使用一个常量，或者以 <code>宽:高</code> 的形式呈现。</p>
<h5><a href="/Pbind/cn/pblayoutmapper#内边距" id=内边距 aria-hidden="true" class="anchor"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>内边距</h5>
<p>内边距的 <code>outer</code> 表示外部参考视图，如果不指定将默认为父视图。<code>{}</code>区间的边距将根据基准尺寸进行自动适配。</p>
<h5><a href="/Pbind/cn/pblayoutmapper#合并居中" id=合并居中 aria-hidden="true" class="anchor"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>合并居中</h5>
<p>将 &#39;/&#39; 区间中的视图添加到一个新的容器视图 merger 中，再对 merger 进行 <em>垂直</em> 或 <em>水平</em> 方向居中约束。</p>

<p>对于：</p>
<div class="highlight highlight-source-text"><pre>C:|-left-[/[name]-[desc]/(==height)]-[icon]-|
          ^^^^^^^^^^^^^^^
              merger
</pre></div>
<p>将会拆成以下约束：</p>

<ul>
<li><code>V:|-left-[merger(==height)]-[icon]-|</code>，对合并容器设置 <em>垂直</em> 方向高度与外边距</li>
<li><code>H:|[name]-[desc]|</code>，对合并容器中的子View设置 <em>水平</em> 方向内边距</li>
<li><code>merge.centerX = super.centerX</code>，对合并容器设置 <em>水平</em> 居中</li>
</ul>

<p>这个公式包含了两个方向的约束，为便于理解，可以把 &#39;/&#39; 理解为切换方向，助记口诀：</p>

<ul>
<li>C外纵内横 (C纵横)</li>
<li>M外横内纵</li>
</ul>

<p>需要注意的是：</p>

<ul>
<li>使用了合并居中约束的子视图，其父视图将变更为容器视图，在 <strong>formats</strong> 里对其设置的相对于原父视图的边距类约束不再生效。</li>
<li>由于直接拆分转成 <em>VFL</em> 来解析，因此其中配置的常量数值不会根据设备进行适配，可以通过 <strong>metrics</strong> 来指定。</li>
</ul>
